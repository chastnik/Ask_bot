# Ask Bot - ะฃะฝะธะฒะตััะฐะปัะฝัะน ัะฐั-ะฑะพั ะดะปั Jira

ะฃะผะฝัะน ะฑะพั ะดะปั ะธะฝัะตะณัะฐัะธะธ ั Jira ะฒ Mattermost ั ะฟะพะดะดะตัะถะบะพะน ะฐะฝะฐะปะธัะธะบะธ, ะฒะธะทัะฐะปะธะทะฐัะธะธ ะธ RAG-ัะธััะตะผั.

## ๐ ะะพะทะผะพะถะฝะพััะธ

- **๐ค ะะฝัะตะปะปะตะบััะฐะปัะฝะพะต ะฟะพะฝะธะผะฐะฝะธะต ะทะฐะฟัะพัะพะฒ** - ะพะฑัะฐะฑะพัะบะฐ ะตััะตััะฒะตะฝะฝะพะณะพ ัะทัะบะฐ ั ะฟะพะผะพััั ะปะพะบะฐะปัะฝะพะน LLM
- **๐ ะะฒัะพะผะฐัะธัะตัะบะฐั ะฐะฝะฐะปะธัะธะบะฐ** - ะณะตะฝะตัะฐัะธั JQL ะทะฐะฟัะพัะพะฒ ะธ ะฐะฝะฐะปะธะท ะดะฐะฝะฝัั Jira
- **๐ ะะธะทัะฐะปะธะทะฐัะธั ะดะฐะฝะฝัั** - ัะพะทะดะฐะฝะธะต ะณัะฐัะธะบะพะฒ ะธ ะดะธะฐะณัะฐะผะผ ะฟะพ ะทะฐะฟัะพัั
- **๐ ะะตะทะพะฟะฐัะฝะฐั ะฐะฒัะพัะธะทะฐัะธั** - ะฟะพะดะดะตัะถะบะฐ ัะพะปะตะฒะพะณะพ ะดะพัััะฟะฐ ะบ Jira
- **โก ะะตัะธัะพะฒะฐะฝะธะต** - ะฑัััััะต ะพัะฒะตัั ะฝะฐ ัะฐัััะต ะทะฐะฟัะพัั ัะตัะตะท Redis
- **๐ง RAG-ัะธััะตะผะฐ** - ะบะพะฝัะตะบััะฝะพะต ะฟะพะฝะธะผะฐะฝะธะต ะบะปะธะตะฝัะพะฒ, ะฟัะพะตะบัะพะฒ ะธ ัะฐะฑะปะพะฝะพะฒ
- **๐ฌ Slash-ะบะพะผะฐะฝะดั** - ัะดะพะฑะฝะพะต ะฒะทะฐะธะผะพะดะตะนััะฒะธะต ัะตัะตะท Mattermost

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Mattermost    โโโโโโ   FastAPI Bot    โโโโโโ      Jira       โ
โ  (Slash ะบะพะผะฐะฝะดั)โ    โ   (Middleware)   โ    โ   (REST API)    โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                              โ
                              โโโ Redis (ะะตั)
                              โโโ SQLite (RAG ะฑะฐะทะฐ)
                              โโโ LLM ะัะพะบัะธ
                              โโโ Plotly (ะัะฐัะธะบะธ)
```

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

- Python 3.11+
- Redis Server
- ะะพัััะฟ ะบ Jira (API Token)
- ะะพัััะฟ ะบ Mattermost (Bot Token)
- ะะพะบะฐะปัะฝะฐั LLM ัะตัะตะท ะฟัะพะบัะธ

## ๐๏ธ ะฃััะฐะฝะพะฒะบะฐ

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั

```bash
git clone <repository-url>
cd Ask_bot
```

### 2. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
pip install -r requirements.txt
```

### 3. ะะฐัััะพะนะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฝะฐ ะพัะฝะพะฒะต `.env.example`:

```bash
# Mattermost ะฝะฐัััะพะนะบะธ
MATTERMOST_URL=https://mm.1bit.support
MATTERMOST_TOKEN=your_mattermost_bot_token
BOT_NAME=ask_bot
MATTERMOST_TEAM_ID=your_team_id
MATTERMOST_SSL_VERIFY=false

# Jira ะฝะฐัััะพะนะบะธ  
JIRA_URL=https://jira.1solution.ru

# LLM ะฝะฐัััะพะนะบะธ
LLM_PROXY_TOKEN=your_llm_proxy_token
LLM_BASE_URL=https://llm.1bitai.ru
LLM_MODEL=qwen3:14b

# ะะฐะทะฐ ะดะฐะฝะฝัั
DATABASE_URL=sqlite:///./askbot.db

# Redis
REDIS_URL=redis://localhost:6379/0

# ะะฑัะธะต ะฝะฐัััะพะนะบะธ
LOG_LEVEL=INFO
SECRET_KEY=your-secret-key-here
DEBUG=false

# ะะฐัััะพะนะบะธ ะฟัะธะปะพะถะตะฝะธั  
HOST=0.0.0.0
PORT=8000

# RAG ะฝะฐัััะพะนะบะธ
EMBEDDING_MODEL=all-MiniLM-L6-v2
MAX_CONTEXT_LENGTH=4000

# ะัะฐัะธะบ ะฝะฐัััะพะนะบะธ
CHART_SAVE_PATH=./charts/
CHART_URL_PREFIX=http://localhost:8000/charts/
```

### 4. ะะฝะธัะธะฐะปะธะทะฐัะธั ะฑะฐะทั ะดะฐะฝะฝัั

```bash
python -c "
from app.models.database import Base
from sqlalchemy import create_engine
from app.config import settings

engine = create_engine(settings.database_url)
Base.metadata.create_all(bind=engine)
print('ะะฐะทะฐ ะดะฐะฝะฝัั ะธะฝะธัะธะฐะปะธะทะธัะพะฒะฐะฝะฐ')
"
```

### 5. ะะฐะฟััะบ Redis

```bash
# Ubuntu/Debian
sudo systemctl start redis-server

# Docker
docker run -d --name redis -p 6379:6379 redis:7-alpine
```

### 6. ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั

```bash
# ะะฐะทัะฐะฑะพัะบะฐ
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

# ะัะพะดะฐะบัะฝ
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

## ๐ณ Docker ัะฐะทะฒะตัััะฒะฐะฝะธะต

### ะัััััะน ะทะฐะฟััะบ

```bash
docker-compose up -d
```

### ะััะฝะฐั ัะฑะพัะบะฐ

```bash
# ะกะฑะพัะบะฐ ะพะฑัะฐะทะฐ
docker build -t ask-bot .

# ะะฐะฟััะบ ะบะพะฝัะตะนะฝะตัะฐ
docker run -d \
  --name ask-bot \
  -p 8000:8000 \
  -v $(pwd)/askbot.db:/app/askbot.db \
  -v $(pwd)/charts:/app/charts \
  --env-file .env \
  ask-bot
```

## ๐ฏ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะตัะฒะฐั ะฝะฐัััะพะนะบะฐ ะฒ Mattermost

1. **ะกะพะทะดะฐะฝะธะต ะฑะพัะฐ ะฒ Mattermost:**
   - ะะตัะตะนะดะธัะต ะฒ System Console โ Integrations โ Bot Accounts
   - ะกะพะทะดะฐะนัะต ะฝะพะฒะพะณะพ ะฑะพัะฐ ั ะธะผะตะฝะตะผ `ask_bot`
   - ะกะบะพะฟะธััะนัะต ัะพะบะตะฝ ะฒ ะฟะตัะตะผะตะฝะฝัั `MATTERMOST_TOKEN`

2. **ะะฐัััะพะนะบะฐ Slash ะบะพะผะฐะฝะดั:**
   - ะะตัะตะนะดะธัะต ะฒ Team Settings โ Integrations โ Slash Commands
   - ะกะพะทะดะฐะนัะต ะบะพะผะฐะฝะดั `/jira` ั URL: `http://your-server:8000/webhooks/slash`

3. **ะะตัะฒัะน ะทะฐะฟััะบ:**
   ```
   /jira help
   ```

### ะะฒัะพัะธะทะฐัะธั ะฒ Jira

ะัะธ ะฟะตัะฒะพะผ ะธัะฟะพะปัะทะพะฒะฐะฝะธะธ ะฑะพั ะทะฐะฟัะพัะธั ััะตัะฝัะต ะดะฐะฝะฝัะต Jira:

```
/jira auth
```

ะะพั ะฟัะตะดะปะพะถะธั ะฒะฒะตััะธ:
- ะะผั ะฟะพะปัะทะพะฒะฐัะตะปั Jira
- API Token (ัะตะบะพะผะตะฝะดัะตััั) ะธะปะธ ะฟะฐัะพะปั

### ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ

#### ๐ ะะฝะฐะปะธัะธัะตัะบะธะต ะทะฐะฟัะพัั

```
/jira ะกะบะพะปัะบะพ ะทะฐะดะฐั ะฑัะปะพ ัะพะทะดะฐะฝะพ ะฟะพ ะบะปะธะตะฝัั ะะปั-ะะต-ะะพัั ะฒ ะธัะปะต?
/jira ะะฐะบะธะต ะทะฐะดะฐัะธ ัะตะนัะฐั ะฒ ััะฐัััะต 'In Progress' ั ะบะพะผะฐะฝะดั ัะพะฟัะพะฒะพะถะดะตะฝะธั?
/jira ะกะบะพะปัะบะพ ัะฐัะพะฒ ัะฟะธัะฐะปะธ ะฒัะต ัะพัััะดะฝะธะบะธ ะฟะพ ะฟัะพะตะบัั Visiology ะฒ ะผะฐะต?
```

#### ๐ ะะฐะฟัะพัั ั ะฒะธะทัะฐะปะธะทะฐัะธะตะน

```
/jira ะะพะบะฐะถะธ ะณัะฐัะธะบ ัะฟะธัะฐะฝะธั ัะฐัะพะฒ ะฟะพ ะกะตัะณะตั ะััะฐะฒะปัะฒั ะทะฐ ะฟะพัะปะตะดะฝะธะต 3 ะผะตัััะฐ
/jira ะะธะฐะณัะฐะผะผะฐ ะทะฐะดะฐั ะฟะพ ััะฐัััะฐะผ ะฟะพ ะบะปะธะตะฝัั ะััะณะตั-ะะธะฝะณ ะทะฐ ะธัะฝั
/jira ะะฐัะฟัะตะดะตะปะตะฝะธะต ะทะฐะดะฐั ะฟะพ ัะธะฟะฐะผ (Bug, Task, Epic) ะฒ ะธัะปะต
```

#### ๐ ะะพะธัะบะพะฒัะต ะทะฐะฟัะพัั

```
/jira ะัะปะธ ะปะธ ะฟัะพััะพัะตะฝะฝัะต ะทะฐะดะฐัะธ ะฟะพ ะฟัะพะตะบัั ะะธััะธะบั ะฒ ะธัะฝะต?
/jira ะะฐะบะธะต ะทะฐะดะฐัะธ ะฑัะปะธ ะพัะบัััั ะฑะพะปะตะต 30 ะดะฝะตะน ะฝะฐะทะฐะด ะธ ะดะพ ัะธั ะฟะพั ะฝะต ัะตัะตะฝั?
/jira ะัะพ ะธะท ัะพัััะดะฝะธะบะพะฒ ะฒ ะธัะฝะต ัะฐะฑะพัะฐะป ะฑะพะปััะต ะฒัะตะณะพ ะฝะฐะด ะทะฐะดะฐัะฐะผะธ ะบะปะธะตะฝัะฐ ะะตััะฐะปั?
```

#### โก ะะพะผะฐะฝะดั ัะฟัะฐะฒะปะตะฝะธั

```
/jira help           # ะกะฟัะฐะฒะบะฐ ะฟะพ ะบะพะผะฐะฝะดะฐะผ
/jira auth           # ะะฐัััะพะนะบะฐ ะฐะฒัะพัะธะทะฐัะธะธ Jira
/jira status         # ะกัะฐััั ัะตัะฒะธัะพะฒ
/jira cache clear    # ะัะธััะบะฐ ะบะตัะฐ
/jira projects       # ะกะฟะธัะพะบ ะดะพัััะฟะฝัั ะฟัะพะตะบัะพะฒ
```

## ๐จ ะขะธะฟั ะณัะฐัะธะบะพะฒ

ะะพั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒัะฑะธัะฐะตั ะฟะพะดัะพะดััะธะน ัะธะฟ ะณัะฐัะธะบะฐ ะธะปะธ ะฒั ะผะพะถะตัะต ัะบะฐะทะฐัั ัะฒะฝะพ:

- **๐ ะกัะพะปะฑัะฐััะต ะดะธะฐะณัะฐะผะผั** - ะดะปั ััะฐะฒะฝะตะฝะธั ะบะพะปะธัะตััะฒะตะฝะฝัั ะดะฐะฝะฝัั
- **๐ ะะธะฝะตะนะฝัะต ะณัะฐัะธะบะธ** - ะดะปั ะฒัะตะผะตะฝะฝัั ััะดะพะฒ
- **๐ฅง ะััะณะพะฒัะต ะดะธะฐะณัะฐะผะผั** - ะดะปั ัะฐัะฟัะตะดะตะปะตะฝะธั ะฟะพ ะบะฐัะตะณะพัะธัะผ
- **๐ ะขะฐะฑะปะธัั** - ะดะปั ะดะตัะฐะปัะฝัั ะดะฐะฝะฝัั
- **๐ ะขะพัะตัะฝัะต ะดะธะฐะณัะฐะผะผั** - ะดะปั ะบะพััะตะปััะธะพะฝะฝะพะณะพ ะฐะฝะฐะปะธะทะฐ

## ๐ง ะัะพะดะฒะธะฝัััะต ะฝะฐัััะพะนะบะธ

### RAG-ัะธััะตะผะฐ

ะะพั ะธัะฟะพะปัะทัะตั ะฑะฐะทั ะทะฝะฐะฝะธะน ะดะปั ะปัััะตะณะพ ะฟะพะฝะธะผะฐะฝะธั ะบะพะฝัะตะบััะฐ:

```python
# ะะพะฑะฐะฒะปะตะฝะธะต ะบะปะธะตะฝัะฐ ะฒ ะฑะฐะทั ะทะฝะฐะฝะธะน
from app.models.database import Client
from sqlalchemy.orm import Session

client = Client(
    name="ะะพะฒัะน ะะปะธะตะฝั",
    jira_key="NC",
    description="ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ ะบะปะธะตะฝัะฐ"
)
```

### ะจะฐะฑะปะพะฝั ะทะฐะฟัะพัะพะฒ

ะกะพะทะดะฐะฝะธะต ะณะพัะพะฒัั ัะฐะฑะปะพะฝะพะฒ ะดะปั ัะฐัััั ะทะฐะฟัะพัะพะฒ:

```python
from app.models.database import QueryTemplate

template = QueryTemplate(
    name="ะะฐะดะฐัะธ ะฟะพ ะบะปะธะตะฝัั ะทะฐ ะผะตััั",
    description="ะะพะปััะธัั ะฒัะต ะทะฐะดะฐัะธ ะบะปะธะตะฝัะฐ ะทะฐ ัะบะฐะทะฐะฝะฝัะน ะผะตััั",
    template='project = "{project}" AND created >= "{start_date}" AND created <= "{end_date}"',
    category="analytics",
    chart_type="bar"
)
```

### ะะฐััะพะผะธะทะฐัะธั ะณัะฐัะธะบะพะฒ

```python
# ะะฐัััะพะนะบะฐ ัะฒะตัะพะฒะพะน ััะตะผั
chart_config = {
    "color_scheme": "jira",  # jira, professional, warm, cool
    "show_values": True,
    "height": 600,
    "width": 1000
}
```

## ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะพัะปะฐะดะบะฐ

### ะะพะณะธ

```bash
# ะัะพัะผะพัั ะปะพะณะพะฒ
tail -f logs/askbot.log

# ะฃัะพะฒะตะฝั ะปะพะณะธัะพะฒะฐะฝะธั ะฒ .env
LOG_LEVEL=DEBUG  # DEBUG, INFO, WARNING, ERROR
```

### ะะตััะธะบะธ ะบะตัะฐ

```
/jira cache stats
```

### ะัะพะฒะตัะบะฐ ัะตัะฒะธัะพะฒ

```
/jira status
```

## ๐ก๏ธ ะะตะทะพะฟะฐัะฝะพััั

### ะจะธััะพะฒะฐะฝะธะต ะฟะฐัะพะปะตะน

ะะฐัะพะปะธ ะธ ัะพะบะตะฝั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ัะธััััััั ะฟะตัะตะด ัะพััะฐะฝะตะฝะธะตะผ ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั.

### ะะณัะฐะฝะธัะตะฝะธั ะดะพัััะฟะฐ

- ะะฐะถะดัะน ะฟะพะปัะทะพะฒะฐัะตะปั ะฒะธะดะธั ัะพะปัะบะพ ัะต ะฟัะพะตะบัั, ะบ ะบะพัะพััะผ ั ะฝะตะณะพ ะตััั ะดะพัััะฟ ะฒ Jira
- ะะตั ะธะทะพะปะธัะพะฒะฐะฝ ะฟะพ ะฟะพะปัะทะพะฒะฐัะตะปัะผ
- ะะพะณะธ ะฝะต ัะพะดะตัะถะฐั ััะฒััะฒะธัะตะปัะฝะพะน ะธะฝัะพัะผะฐัะธะธ

### ะะตะบะพะผะตะฝะดะฐัะธะธ

1. ะัะฟะพะปัะทัะนัะต API ัะพะบะตะฝั Jira ะฒะผะตััะพ ะฟะฐัะพะปะตะน
2. ะะฐัััะพะนัะต HTTPS ะดะปั ะฟัะพะดะฐะบัะฝ ัะฐะทะฒะตัััะฒะฐะฝะธั
3. ะะตะณัะปััะฝะพ ะพะฑะฝะพะฒะปัะนัะต ะทะฐะฒะธัะธะผะพััะธ
4. ะะณัะฐะฝะธัััะต ัะตัะตะฒะพะน ะดะพัััะฟ ะบ Redis

## ๐ ะะฑะฝะพะฒะปะตะฝะธะต

```bash
# ะััะฐะฝะพะฒะบะฐ ัะตัะฒะธัะฐ
docker-compose down

# ะะฑะฝะพะฒะปะตะฝะธะต ะบะพะดะฐ
git pull origin main

# ะะฑะฝะพะฒะปะตะฝะธะต ะทะฐะฒะธัะธะผะพััะตะน
pip install -r requirements.txt

# ะะธะณัะฐัะธั ะฑะฐะทั ะดะฐะฝะฝัั (ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ)
# python migrations/migrate.py

# ะะตัะตะทะฐะฟััะบ
docker-compose up -d
```

## ๐ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะงะฐัััะต ะฟัะพะฑะปะตะผั

1. **ะัะธะฑะบะฐ ะฟะพะดะบะปััะตะฝะธั ะบ Redis**
   ```bash
   # ะัะพะฒะตัะธัั ััะฐััั Redis
   redis-cli ping
   # ะัะฒะตั ะดะพะปะถะตะฝ ะฑััั: PONG
   ```

2. **ะัะธะฑะบะฐ ะฐะฒัะพัะธะทะฐัะธะธ Jira**
   ```
   /jira auth  # ะะพะฒัะพัะฝะฐั ะฝะฐัััะพะนะบะฐ
   ```

3. **LLM ะฝะต ะพัะฒะตัะฐะตั**
   - ะัะพะฒะตัััะต ะดะพัััะฟะฝะพััั LLM ะฟัะพะบัะธ
   - ะฃะฑะตะดะธัะตัั ะฒ ะบะพััะตะบัะฝะพััะธ ัะพะบะตะฝะฐ

4. **ะัะฐัะธะบะธ ะฝะต ัะพะทะดะฐัััั**
   - ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะฝะฐ ะทะฐะฟะธัั ะฒ ะดะธัะตะบัะพัะธั `charts/`
   - ะฃััะฐะฝะพะฒะธัะต `kaleido` ะดะปั Plotly

### ะะพะณะธ ะพัะปะฐะดะบะธ

```bash
# ะะบะปััะธัั ะฟะพะดัะพะฑะฝัะต ะปะพะณะธ
export LOG_LEVEL=DEBUG

# ะัะพัะผะพัั ะปะพะณะพะฒ FastAPI
uvicorn app.main:app --log-level debug
```

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

1. Fork ัะตะฟะพะทะธัะพัะธั
2. ะกะพะทะดะฐะนัะต feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit ะธะทะผะตะฝะตะฝะธั (`git commit -m 'Add some AmazingFeature'`)
4. Push ะฒ branch (`git push origin feature/AmazingFeature`)
5. ะัะบัะพะนัะต Pull Request

## ๐ ะะธัะตะฝะทะธั

ะญัะพั ะฟัะพะตะบั ัะฐัะฟัะพัััะฐะฝัะตััั ะฟะพะด ะปะธัะตะฝะทะธะตะน MIT. ะกะผ. ัะฐะนะป `LICENSE` ะดะปั ะฟะพะดัะพะฑะฝะพััะตะน.

## ๐ ะะพะดะดะตัะถะบะฐ

- **ะะพะบัะผะตะฝัะฐัะธั:** [Wiki](https://github.com/your-repo/wiki)
- **Issues:** [GitHub Issues](https://github.com/your-repo/issues)
- **ะงะฐั ะฟะพะดะดะตัะถะบะธ:** [Mattermost Channel]

## ๐ ะะปะฐะณะพะดะฐัะฝะพััะธ

- [FastAPI](https://fastapi.tiangolo.com/) - ะฒะตะฑ-ััะตะนะผะฒะพัะบ
- [Plotly](https://plotly.com/python/) - ะฒะธะทัะฐะปะธะทะฐัะธั ะดะฐะฝะฝัั
- [Jira REST API](https://developer.atlassian.com/server/jira/platform/rest-apis/)
- [Mattermost API](https://api.mattermost.com/)

---

**Ask Bot** - ะดะตะปะฐะตะผ ัะฐะฑะพัั ั Jira ะฟัะพัะต ะธ ะฝะฐะณะปัะดะฝะตะต! ๐ 